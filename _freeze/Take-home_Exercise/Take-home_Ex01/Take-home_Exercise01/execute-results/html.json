{
  "hash": "42846b48f36569d078ee24c6c1dd2269",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home_Exercise01\"\nauthor: \"xu xinyi\"\nformat: html\neditor: visual\ndate-modified: \"last-modified\"\ndescription: \"Creating enlightening and truthful data visualizations\"\ncategories: [tidyverse, haven,ggrepel, ggthemes,ggridges, ggdist,patchwork, scales] \nexecute: \n       echo: true \n       eval: true \n       warning: false \n       freeze: true\n---\n\n\n\n# Overview\n\n## Setting the scene\n\nA local online media company that publishes daily content on digital platforms is planning to release an article on demographic structures and distribution of Singapore in 2024.\n\n## Our task\n\nAssuming the role of the graphical editor of the media company, you are tasked to prepare [**at most three data visualisation**]{.underline} for the article.The data should be processed by using appropriate **tidyverse** family of packages and the data visualisation must be prepared using **ggplot2** and its extensions.\n\n# Getting Started\n\n## Loading packages\n\nWe load the following R packages using the **pacman::p_load()** function:\n\n-   **tidyverse**: Core collection of R packages designed for data science.\n\n-   **haven**: To read in data formats such as SAS and SPSS.\n\n-   **ggrepel**: to provides geoms for ggplot2 to repel overlapping text labels.\n\n-   **ggthemes**: to use additional themes for ggplot2.\n\n-   **patchwork**: to prepare composite figure created using ggplot2.\n\n-   **ggridges**: to plot ridgeline plots.\n\n-   **ggdist**: for visualizations of distributions and uncertainty.\n\n-   **scales**: provides the internal scaling infrastructure used by ggplot2.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, haven,\n               ggrepel, ggthemes,\n               ggridges, ggdist,\n               patchwork, scales, ggExtra)\n```\n:::\n\n\n\n## Import data\n\nTo accomplish the task, Singapore Residents by Planning Area / Subzone, Single Year of Age and Sex, June 2024 dataset shares by [Department of Statistics, Singapore (DOS)](https://www.singstat.gov.sg/) should be used.\n\nThe code chunk below imports *respopagesex2024.csv* into R environment by using [read_csv()](https://readr.tidyverse.org/reference/read_delim.html)function of [readr](https://readr.tidyverse.org/) package. [**readr**]{.underline} is one of the tidyverse package.\n\nWe import this dataset as *sgresident*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgresident <- read_csv(\"respopagesex2024.csv \")\n```\n:::\n\n\n\n## Data pre-processing\n\nWe first take a look at the data and check if there are any duplicates.\n\n## Glimpse of data\n\nUsing the **glimpse()** function, we see that the dataset consists of 60,424 rows and 6 columns. It also shows the data type of each columns and first few entries of each columns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(sgresident)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60,424\nColumns: 6\n$ PA   <chr> \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo K…\n$ SZ   <chr> \"Ang Mo Kio Town Centre\", \"Ang Mo Kio Town Centre\", \"Ang Mo Kio T…\n$ Age  <chr> \"0\", \"0\", \"1\", \"1\", \"2\", \"2\", \"3\", \"3\", \"4\", \"4\", \"5\", \"5\", \"6\", …\n$ Sex  <chr> \"Males\", \"Females\", \"Males\", \"Females\", \"Males\", \"Females\", \"Male…\n$ Pop  <dbl> 10, 10, 10, 10, 10, 10, 10, 10, 30, 10, 20, 10, 20, 30, 30, 10, 3…\n$ Time <dbl> 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024,…\n```\n\n\n:::\n:::\n\n\n\n## Check for duplicates\n\nUsing the **duplicated()** function, we see that there are no duplicate entries in the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgresident[duplicated(sgresident),]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 6\n# ℹ 6 variables: PA <chr>, SZ <chr>, Age <chr>, Sex <chr>, Pop <dbl>,\n#   Time <dbl>\n```\n\n\n:::\n:::\n\n\n\nThere is 0 rows that has duplicated results. The next step will be changing the inappropriate data type and checking for missing values as we needed. Due there are only 6 columns (which means 6 variables only), it is not neccessary for us to filter variables anymore.\n\n## Change data type of selected variables\n\nVariables with inappropriate data type are Age, Sex, Time. Starting from Age:\n\nThe [**as.numeric()**](https://www.geeksforgeeks.org/as-numeric-function-in-r/) function in R is a crucial tool for data manipulation, allowing users to convert data into numeric form.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgresident <- sgresident %>% \n  mutate(Age = as.numeric(Age))\n```\n:::\n\n\n\nConverting Sex column for better visualization, especially for consistent ordering and coloring in plots. Coloring in plots especially assign specific colors in ggplot2 will be easier. Converting Sec column to a factor with explicit levels: \"Males\" and \"Females\". This can prevent mismatches or typos.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgresident <- sgresident %>%\n  mutate(Sex = factor(Sex, levels = c(\"Males\", \"Females\")))\n```\n:::\n\n\n\nMaking sure about the Time column consisted of discrete numbers, transforming Time from <dbl> to <int> is the way to go.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsgresident <- sgresident %>%\n  mutate(Time = as.integer(Time))\n```\n:::\n\n\n\n## Check for missing values\n\nMany datasets store missing data as text placeholders like \"NA\" and \"NULL\". But in R ecosystem, \"NA\" may not be recognized. Coverting data first can expose hidden issues and make accurate statistical summaries like using `mean()` and `boxplot()` functions. [is.na()](https://www.geeksforgeeks.org/how-to-use-is-na-in-r/) function can checkthe missing values for each columns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(sgresident ))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  PA   SZ  Age  Sex  Pop Time \n   0    0  664    0    0    0 \n```\n\n\n:::\n:::\n\n\n\nThe age column has 664 missing values, which have been stored as strings before data type conversion. In this case, we do not need to remove those data.\n\n## Preview pre-processed dataframe\n\nWe use the function **head()** to preview the first few rows of the pre-processed dataframe:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(sgresident, 200)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 200 × 6\n   PA         SZ                       Age Sex       Pop  Time\n   <chr>      <chr>                  <dbl> <fct>   <dbl> <int>\n 1 Ang Mo Kio Ang Mo Kio Town Centre     0 Males      10  2024\n 2 Ang Mo Kio Ang Mo Kio Town Centre     0 Females    10  2024\n 3 Ang Mo Kio Ang Mo Kio Town Centre     1 Males      10  2024\n 4 Ang Mo Kio Ang Mo Kio Town Centre     1 Females    10  2024\n 5 Ang Mo Kio Ang Mo Kio Town Centre     2 Males      10  2024\n 6 Ang Mo Kio Ang Mo Kio Town Centre     2 Females    10  2024\n 7 Ang Mo Kio Ang Mo Kio Town Centre     3 Males      10  2024\n 8 Ang Mo Kio Ang Mo Kio Town Centre     3 Females    10  2024\n 9 Ang Mo Kio Ang Mo Kio Town Centre     4 Males      30  2024\n10 Ang Mo Kio Ang Mo Kio Town Centre     4 Females    10  2024\n# ℹ 190 more rows\n```\n\n\n:::\n:::\n\n\n\n# EDA 1:Age-Sex population pyramid\n\nPopulation Pyramid (Singapore, 2024) This population pyramid displays Singapore’s age distribution in 2024 by gender. The left side represents male population counts, while the right shows female counts. A symmetrical shape is observed through most of the age range, though older ages (70+) show a higher proportion of women, reflecting longer female life expectancy. The peak is concentrated between ages 30 to 50, indicative of a mature working-age population.\n\nThe code chunk below shows the Age-Sex population pyramid:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npyramid_data <- sgresident %>%\n  group_by(Age, Sex) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  mutate(Pop = ifelse(Sex == \"Males\", -Pop, Pop))\n\nggplot(pyramid_data, aes(x = Age, y = Pop, fill = Sex)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_flip() +\n  scale_y_continuous(labels = abs) +\n  scale_fill_manual(values = c(\"Males\" = \"#1f77b4\", \"Females\" = \"#ff7f0e\")) +\n  labs(\n    title = \"Population Pyramid (Singapore, 2024)\",\n    x = \"Age\", y = \"Population Count\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Exercise01_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n# EDA 2: Pareto Dot Plot – Total Population by Top 20 subzones\n\nThis Pareto dot plot visualizes the 20 most populous subzones in Singapore in 2024, sorted in descending order by population. Each dot represents a subzone, while the dotted line tracks the cumulative percentage of the total population covered. The plot reveals that just a few subzones, contribute a disproportionately large share of the national population. The cumulative line provides a clear demarcation of the \"vital few\" subzones that drive national population density.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npareto_sz <- sgresident %>%\n  group_by(SZ) %>%\n  summarise(Total_Pop = sum(Pop), .groups = \"drop\") %>%\n  arrange(desc(Total_Pop)) %>%\n  mutate(\n    Cum_Perc = cumsum(Total_Pop) / sum(Total_Pop) * 100,\n    SZ = factor(SZ, levels = rev(SZ))\n  )\n\n# show only top 20 subzones\npareto_sz_top <- pareto_sz %>% slice_max(Total_Pop, n = 20)\n\nggplot(pareto_sz_top, aes(x = reorder(SZ, Total_Pop), y = Total_Pop)) +\n  geom_point(color = \"darkgreen\", size = 3) +\n  geom_line(aes(group = 1), linetype = \"dashed\") +\n  geom_text(aes(label = paste0(round(Cum_Perc, 1), \"%\")),\n            hjust = -0.1, size = 3) +\n  scale_y_continuous(labels = comma) +\n  coord_flip() +\n  labs(\n    title = \"Pareto Dot Plot: Population by Subzone (Top 20)\",\n    x = \"Subzone\", y = \"Total Population\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.y = element_text(size = 8))\n```\n\n::: {.cell-output-display}\n![](Take-home_Exercise01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n# EDA 3: Box Plot with Data Superimposed – Population by Age Group (30–49), Across Planning Areas (2024)\n\nData values superimposed on the box plots to aid in visualization. Center lines show the medians, box limits indicate the 25th and 75th percentiles as determined by R software, whiskers extend 1.5 times the interquartile range from the 25th and 75th percentiles, outliers are represented by dots, and data points are plotted as open circles.This faceted box plot displays population distributions for ages 30–49 across six major planning areas. Within each PA, age groups are compared using boxplots with superimposed data points. Tampines and Bedok show relatively high and consistent populations across all age bands, while others like Sengkang and Punggol show peaks around 35–44, reflecting their family-centric demographic. The log scale highlights disparities between dense and sparse subzone populations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Prepare data\ndf_pa_box <- sgresident %>%\n  mutate(\n    Age = as.numeric(Age),\n    AgeGroup = cut(\n      Age,\n      breaks = seq(0, 100, by = 5),\n      right = FALSE,\n      include.lowest = TRUE,\n      labels = paste(seq(0, 95, by = 5), seq(4, 99, by = 5), sep = \"-\")\n    )\n  ) %>%\n  filter(Age >= 30, Age < 50) %>%\n  drop_na(AgeGroup)\n\n# Optional: focus only on top 6 PAs for readability\ntop6_pa <- df_pa_box %>%\n  group_by(PA) %>%\n  summarise(Total_Pop = sum(Pop)) %>%\n  arrange(desc(Total_Pop)) %>%\n  slice_head(n = 6) %>%\n  pull(PA)\n\ndf_pa_box <- df_pa_box %>% filter(PA %in% top6_pa)\n\n# Step 2: Boxplot with jittered data, faceted by PA\nggplot(df_pa_box, aes(x = AgeGroup, y = Pop)) +\n  geom_boxplot(fill = \"steelblue\", alpha = 0.6, outlier.shape = NA) +\n  geom_jitter(width = 0.2, alpha = 0.4, color = \"black\", size = 0.8) +\n  scale_y_log10() +\n  facet_wrap(~ PA, scales = \"free_y\") +\n  labs(\n    title = \"Population Distribution by Age Group (30–49), Faceted by Planning Area\",\n    x = \"Age Group\", y = \"Population (log scale)\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Exercise01_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n# Summary and conclusion\n\nThis report presents three curated visualizations that highlight key patterns in Singapore's demographic structure for 2024, based on official data from the Department of Statistics.\n\n-   The Age-Sex Population Pyramid reveals a balanced gender distribution across most age groups, with a noticeable dominance of females beyond age 70 due to higher life expectancy. The working-age population (30–50) remains the largest cohort.\n\n-   The Pareto Dot Plot of Subzones demonstrates the classic 80/20 principle, with a small number of subzones contributing disproportionately to the national population. This indicates spatial concentration and potential pressure points for urban planning.\n\n-   The Box Plot of Population by Age Group (30–49) Across Planning Areas compares how the middle-aged population is distributed within Singapore’s most populous PAs.\n\n# References\n\n-   [The Box Plots Alternative for Visualizing Quantitative Data](https://onlinelibrary.wiley.com/doi/pdf/10.1016/j.pmrj.2016.02.001)\n\n-   [Population pyramid](https://en.wikipedia.org/wiki/Population_pyramid)\n\n-   [Pareto chart](https://en.wikipedia.org/wiki/Pareto_chart)\n",
    "supporting": [
      "Take-home_Exercise01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}